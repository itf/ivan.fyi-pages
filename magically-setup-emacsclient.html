<!doctype html><html lang=en-US><head><script integrity=sha384-pb++s6uBRKaQv+iAXpgA/H3IlpLZdO14tTwuCI7uXmz4aaZdByoCcM+6BhynMq/1 src=/js/theme.min.js></script><link href="/abridge.css?h=2d5f27cf75270b66b7d2" rel=stylesheet><meta charset=utf-8><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content=/ name=base><meta content=True name=HandheldFriendly><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=default name=apple-mobile-web-app-status-bar-style><meta content=#333333 name=theme-color><meta content=#333333 name=msapplication-TileColor><link href=/manifest.json rel=manifest><link color=#ff9900 href=/safari-pinned-tab.svg rel=mask-icon><link href=/favicon.svg rel=icon type=image/svg+xml><link href=/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link title="Ivan.fyi Atom Feed" href=/atom.xml rel=alternate type=application/atom+xml><meta content="index, follow" name=robots><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=googlebot><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=bingbot><title>Magically setup emacsclient | Ivan.fyi</title><meta content="Ivan Tadeu Ferreira Antunes Filho" name=author><meta content=Ivan.fyi name=copyright><meta content="Ivan Tadeu Ferreira Antunes Filho, software engineer in Cambridge, Massachussets, Boston Area" name=description><link href=/magically-setup-emacsclient.html rel=canonical><meta content="Ivan Tadeu Ferreira Antunes Filho, Ivan Antunes Filho, Software Engineer, Backend, Rust, Scala, Elisp" name=keywords><meta content=/magically-setup-emacsclient.html property=og:url><meta content=/magically-setup-emacsclient.html name=twitter:url><meta content="Ivan Tadeu Ferreira Antunes Filho, software engineer in Cambridge, Massachussets, Boston Area" property=og:description><meta content="Ivan Tadeu Ferreira Antunes Filho, software engineer in Cambridge, Massachussets, Boston Area" name=twitter:description><meta content="Magically setup emacsclient | Ivan.fyi" property=og:title><meta content="Magically setup emacsclient | Ivan.fyi" name=twitter:title><meta content=summary name=twitter:card><meta content=Ivan.fyi property=og:site_name><meta content=en_US property=og:locale><meta content=website property=og:type><meta content=2019-08-02 property=og:updated_time><script src="/js/abridge_nopwa.min.js?h=da86cb0a199b3ccbdff1" defer integrity=sha384-vIpObQoso10COS540XqkYFIjE+P0OwczzYDnC2D28QZ8O6slixwCc+F1xxYZKvFr></script><noscript><link href=/nojs.css rel=stylesheet></noscript><body><header><nav><div><big><a href=/ title=Ivan.fyi>Ivan.fyi</a></big></div><div><div><ul><li><a href=/about.html> About </a><li><a href=/archive/> Archive </a><li><a href=/blog/> Blog </a><li><a href=/portfolio.html> Portfolio </a><li><a href=/resume.html> Resume </a><li><i class="js svgs adjust" id=mode type=reset></i></ul></div><div><div><form autocomplete=off class=js id=searchbox name=goSearch><div class=searchd><input id=searchinput placeholder=Search title=Search><button class=si title=Search>⌕</button></div><div class=results><div id=suggestions></div></div></form></div></div></div></nav><hr></header><main><article><h1><a href=/magically-setup-emacsclient.html>Magically setup emacsclient</a></h1><span class=s95> May 25, 2019<span class=hpad> </span>Updated: August 02, 2019<span class=hpad> </span> #<a href=/tags/tech/>tech</a> </span><p>This is a magical way of automatically setting up emacsclient, by <a href=https://en.reddit.com/user/northrupthebandgeek>northrupthebandgeek</a>. If you start emacs for the first time, it will start a server. If the server has already been started, it will delegate to emacsclient.<p>One tiny improvement over the function defined on the <a href=https://en.reddit.com/r/emacs/comments/4586eq/quick_emacs_snippet_to_automatically_use/>reddit post</a>, is that this doesn't guess what is the name of the emacs server file. It instead generates the nam e in the same ways as done by the server package.<pre class="language-el z-code" data-lang=el><code class=language-el data-lang=el><span class="z-source z-lisp"><span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; from: https://en.reddit.com/r/emacs/comments/4586eq/quick_emacs_snippet_to_automatically_use/
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>;
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; Automagical EmacsClient functionality
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>;
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; Basically, if Emacs is already running, this shunts things over to
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; the existing Emacs; otherwise, it readies itself to accept said
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; shunting.
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>;
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; This operates by detecting the existence of an Emacs server socket
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; file.  If a socket is found, Emacs will
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; spin up emacsclient and immediately exit itself.  Otherwise, Emacs
</span></span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>; will start a new server.
</span></span><span class="z-source z-lisp">    
</span><span class="z-source z-lisp">    
</span><span class="z-source z-lisp">    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">server-already-running-p</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp">      <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>Is Emacs already running?
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-string z-quoted z-double z-lisp">    Gets name based on server-force-delete.<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>
</span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp">           <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">let</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>file <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">expand</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name
</span></span></span></span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">                        server<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name
</span></span></span></span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">    		    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">if</span> server<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>use<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>tcp
</span></span></span></span></span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">    		        server<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>auth<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>dir
</span></span></span></span></span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">    		      server<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>socket<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>dir<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>exists<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>p file<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span><span class="z-source z-lisp">    
</span><span class="z-source z-lisp">    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">server-shunt</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp">      <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>Shunts to emacsclient<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>
</span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp">           <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">let</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>args <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">append</span> '<span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>emacsclient<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>-a<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span><span class="z-constant z-character z-escape z-lisp">\"</span><span class="z-constant z-character z-escape z-lisp">\"</span><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>-c<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>-n<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span></span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">                               <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">cdr</span> command<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>line<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>args<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>shell<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>command <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>substring <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">format</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>%S<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> args<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-constant z-numeric z-lisp">1</span> <span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-constant z-numeric z-lisp">1</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>kill<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>emacs<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span><span class="z-source z-lisp">    
</span><span class="z-source z-lisp">    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">unless</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>featurep 'server<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp">      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">unless</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">boundp</span> 'server<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>process<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">require</span> 'server<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></span></span><span class="z-source z-lisp"><span class="z-meta z-group z-lisp"><span class="z-meta z-group z-lisp">        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">if</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>server<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>already<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>running<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>p<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>server<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>shunt<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>server<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>start<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span><span class="z-source z-lisp">    <span class="z-comment z-line z-semicolon z-lisp"><span class="z-punctuation z-definition z-comment z-lisp">;</span>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
</span></span></code></pre><nav><div><a href=/automatic-latex-fragment-toggling-in-org-mode.html>‹ Automatic Latex Fragment Toggling in org-mode</a></div><div><a href=/code.html> Code ›</a></div></nav></article></main><footer><hr><div class=c><nav class=tpad><div><a title="Ivan.fyi Atom Feed" href=/atom.xml target=_blank type=application/atom+xml><i class="svg rss" title="Ivan.fyi Atom Feed" type=Button></i></a><a class="js m-protected" href=#aXRhZGV1ZmFAZ21haWwuY29t target=_blank title=Mail><i class="svg mail" title=Mail type=Button></i></a><a href=https://www.linkedin.com/in/ivan-tadeu-ferreira-antunes-filho-8b2b0950/ target=_blank title=LinkedIn><i class="svg linkedin" title=LinkedIn type=Button></i></a><a href=https://www.researchgate.net/profile/Ivan-Tadeu-Ferreira-Antunes-Filho/ target=_blank title=ResearchGate><i class="svg researchgate" title=ResearchGate type=Button></i></a><a href=https://github.com/itf/ target=_blank title=Github><i class="svg github" title=Github type=Button></i></a><a href=https://www.instagram.com/ivan_af_/ target=_blank title=Instagram><i class="svg instagram" title=Instagram type=Button></i></a></div></nav><p class=s90>© <span id=year>2025</span> Ivan.fyi<p class=s90>Powered by <a href=https://www.getzola.org/ target=_blank>Zola</a> & <a href=https://github.com/jieiku/abridge/ target=_blank>Abridge</a></div></footer>