<!doctype html><html lang=en-US><head><script integrity=sha384-pb++s6uBRKaQv+iAXpgA/H3IlpLZdO14tTwuCI7uXmz4aaZdByoCcM+6BhynMq/1 src=/js/theme.min.js></script><link href="/abridge.css?h=f13d908213237f414e8a" rel=stylesheet><meta charset=utf-8><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="width=device-width,initial-scale=1" name=viewport><script src="/js/abridge.min.js?h=7a008ae54f397de4791e" defer integrity=sha384-jWwR5syXn2tklQhfP11jqm8HMndEVkXtIwiozHBykMgdpgb7hy3apk7Zaj8t7ekR></script><meta content=/ name=base><meta content="index, follow" name=robots><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=googlebot><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=bingbot><title>Emacs drag-drop pdfs, paste html, custom templates | Ivan.fyi</title><meta content="Ivan Tadeu Ferreira Antunes Filho" name=author><meta content=Ivan.fyi name=copyright><meta content="Ivan Tadeu Ferreira Antunes Filho, software engineer in Cambridge, Massachussets, Boston Area" name=description><link href=/emacs-drag-drop-pdfs-paste-html-custom-templates.html rel=canonical><meta content="Ivan Tadeu Ferreira Antunes Filho, Ivan Antunes Filho, Software Engineer, Backend, Rust, Scala, Elisp" name=keywords><meta content=/emacs-drag-drop-pdfs-paste-html-custom-templates.html property=og:url><meta content=/emacs-drag-drop-pdfs-paste-html-custom-templates.html name=twitter:url><meta content="Ivan Tadeu Ferreira Antunes Filho, software engineer in Cambridge, Massachussets, Boston Area" property=og:description><meta content="Ivan Tadeu Ferreira Antunes Filho, software engineer in Cambridge, Massachussets, Boston Area" name=twitter:description><meta content="Emacs drag-drop pdfs, paste html, custom templates | Ivan.fyi" property=og:title><meta content="Emacs drag-drop pdfs, paste html, custom templates | Ivan.fyi" name=twitter:title><meta content=summary name=twitter:card><meta content=Ivan.fyi property=og:site_name><meta content=en_US property=og:locale><meta content=website property=og:type><meta content=2020-07-26 property=og:updated_time><meta content=True name=HandheldFriendly><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=default name=apple-mobile-web-app-status-bar-style><meta content=#333333 name=theme-color><meta content=#333333 name=msapplication-TileColor><link href=/manifest.json rel=manifest><link color=#ff9900 href=/safari-pinned-tab.svg rel=mask-icon><link href=/favicon.svg rel=icon type=image/svg+xml><link href=/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/favicon-16x16.png rel=icon sizes=16x16 type=image/png><noscript><link href=/nojs.css rel=stylesheet></noscript><body><header><nav><div><h1><a href=/>Ivan.fyi</a></h1></div><div><a href=/about.html> About </a><a href=/archive/> Archive </a><a href=/blog/> Blog </a><a href=/portfolio.html> Portfolio </a><a href=/resume.html> Resume </a><i class="js svgs adjust" id=mode type=reset></i></div><div><form autocomplete=off class=js id=searchbox name=goSearch><div class=searchd><input id=searchinput placeholder=Search title=Search><button class=si title=Search>âŒ•</button></div><div class=results><div id=suggestions></div></div></form></div></nav><hr></header><main><article><h1><a href=/emacs-drag-drop-pdfs-paste-html-custom-templates.html>Emacs drag-drop pdfs, paste html, custom templates</a></h1><span class=s95>August 19, 2018<span class=hpad> </span> Updated: July 26, 2020<span class=hpad> </span> #<a href=/archive/#blog>blog</a> </span><h1 id=UPDATE:>UPDATE:</h1><p>This documents my first experience with programming in elisp. In restrospect, I was really bad at it. This post then shows that you can still make something with elisp even if you are bad at it.<p>A slightly better example of making something with elisp is on my package clipboard2org, a tiny package to paste html or picture. See <a href=https://github.com/itf/clipboard2org/blob/master/clipboard2org.el>clipboard2org</a><h1 id=PDF_files_drag-drop>PDF files drag-drop</h1><p>I wanted to be able to drag and drop pdf files, as well as drag and drop pdf URLs to emacs. The result of dragging should be to download the file to a directory under the same directory as the org file you are editing and then create a link to the file. It also allows for drag and drop of image files.<p>The code was based on <a href=https://github.com/abo-abo/org-download>org download</a>. If it is not a pdf, or if it is but the download fails, it fails back to the original drag and drop code.<pre class="language-el z-code" data-lang=el><code class=language-el data-lang=el><span class="z-source z-lisp">    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">org-file-copy-pdf</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>fname<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">let</span><span class="z-keyword z-operator z-arithmetic z-lisp">*</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>path <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>substring fname <span class="z-constant z-numeric z-lisp">5</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">directory</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>./pdflib<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>name <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>nondirectory <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>sans<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>extension path<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>make<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">directory</span> org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">directory</span> :parents<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>condition<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-keyword z-control z-lisp">case</span> nill
            <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>copy<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>unescape<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>uri path<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">expand</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">format</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>%s.pdf<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> name<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">directory</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
          <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">error</span>
           <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
          <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>relative<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">expand</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">format</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>%s.pdf<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> name<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">directory</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>./<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">org-file-insert</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>fname<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">let</span><span class="z-keyword z-operator z-arithmetic z-lisp">*</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>img<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>regexp <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span><span class="z-constant z-character z-escape z-lisp">\\</span>([pP][nN][gG]<span class="z-constant z-character z-escape z-lisp">\\</span>|[jJ][pP][eE]?[gG]<span class="z-constant z-character z-escape z-lisp">\\</span>)<span class="z-constant z-character z-escape z-lisp">\\</span>><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>regexp  <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span><span class="z-constant z-character z-escape z-lisp">\\</span>([pP][dD][fF]<span class="z-constant z-character z-escape z-lisp">\\</span>)<span class="z-constant z-character z-escape z-lisp">\\</span>><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">cond</span>  
         <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">string</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>match img<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>regexp fname<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
          <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>insert <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>#+ATTR_ORG: :width 300<span class="z-constant z-character z-escape z-lisp">\n</span><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
          <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>insert <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>concat  <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>#+CAPTION: <span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>  <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span><span class="z-constant z-character z-escape z-lisp">\n</span><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
          <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>insert <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">format</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>[[%s]]<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> fname<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
          <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>display<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>inline<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>images <span class="z-constant z-language z-lisp">t</span> <span class="z-constant z-language z-lisp">t</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
         <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">string</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>match pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>regexp fname<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
          <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>insert <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">format</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>[[file:%s][%s]]<span class="z-constant z-character z-escape z-lisp">\n</span><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>  <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>copy<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf fname<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>nondirectory <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>sans<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>extension path<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
         <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-constant z-language z-lisp">t</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>insert <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">format</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>[[%s]]<span class="z-constant z-character z-escape z-lisp">\n</span><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> fname<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
            <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
         <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">org-file-dnd-fallback</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>uri action<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">let</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>protocol<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>alist
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>rassq<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">delete</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>all
              'org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>protocol
              <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">copy-alist</span> dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>protocol<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>alist<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>handle<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>one<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>url <span class="z-constant z-language z-lisp">nil</span> action uri<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">org-file-dnd-protocol</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>uri action<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">cond</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-operator z-comparison z-lisp">eq</span> major<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode 'org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>condition<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-keyword z-control z-lisp">case</span> <span class="z-constant z-language z-lisp">nil</span>
                 <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>insert uri<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
               <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">error</span>
                <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>fallback uri action<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
            <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-constant z-language z-lisp">t</span>
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>fallback uri action<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>add<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-keyword z-control z-lisp">to</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">list</span> 'dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>protocol<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>alist '<span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>^file:<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> .  org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>protocol<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">require</span> 'url<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">org-file-pdf-url-insert</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>url<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">let</span><span class="z-keyword z-operator z-arithmetic z-lisp">*</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">directory</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>./pdflib<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>name <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>nondirectory url<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>path <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">expand</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>nondirectory url<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">directory</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>relative<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>path <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>relative<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>name path <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>./<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>make<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">directory</span> org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">directory</span> :parents<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>url<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>copy<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file url path <span class="z-constant z-language z-lisp">t</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>insert <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">format</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>[[file:%s][%s]]<span class="z-constant z-character z-escape z-lisp">\n</span><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>  relative<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>path name<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">org-file-pdf-url-dnd-fallback</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>uri action<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">let</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>protocol<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>alist
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>rassq<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">delete</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>all
              'org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>url<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>protocol
              <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">copy-alist</span> dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>protocol<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>alist<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>handle<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>one<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>url <span class="z-constant z-language z-lisp">nil</span> action uri<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">org-file-pdf-url-dnd-protocol</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>uri action<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">cond</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-operator z-comparison z-lisp">eq</span> major<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode 'org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>condition<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-keyword z-control z-lisp">case</span> <span class="z-constant z-language z-lisp">nil</span>
                 <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>url<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>insert uri<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
               <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">error</span>
                <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>url<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>fallback uri action<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
            <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-constant z-language z-lisp">t</span>
             <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>url<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>fallback uri action<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>add<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-keyword z-control z-lisp">to</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">list</span> 'dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>protocol<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>alist '<span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>^https?.*<span class="z-constant z-character z-escape z-lisp">\\</span>.pdf<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> .  org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>file<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>pdf<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>url<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>dnd<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>protocol<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></code></pre><h1 id=Custom_easy_templates>Custom easy templates</h1><p>Easy templates cannot run arbitrary code. They are handled by org-cycle, which is a function that handles every action that TAB performs in org mode.<p>So, I created a function and added an advice to org-cycle, This detects strings of the type "<code>>[a-zA-Z]+</code>", i.e. > followed by letters and then runs a function.<p>In order to create other templates, add another block similar to<pre class="language-el z-code" data-lang=el><code class=language-el data-lang=el><span class="z-source z-lisp">    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">string</span><span class="z-keyword z-operator z-comparison z-lisp">=</span> key <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>t<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>insert<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>todays<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>date<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    <span class="z-constant z-language z-lisp">t</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></code></pre><p>under it.<p>This particular template inserts today's date when someone writes >t and presses tab.<pre class="language-el z-code" data-lang=el><code class=language-el data-lang=el><span class="z-source z-lisp">    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">insert-todays-date</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>interactive<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>insert <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">format</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">time</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">string</span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span><%Y-%m-%d><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">org-try-my-template-function</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>&optional arg<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>Try to complete a structure template before point.
    This looks for strings like <span class="z-constant z-character z-escape z-lisp">\"</span>&LTe<span class="z-constant z-character z-escape z-lisp">\"</span> on an otherwise empty line and
    expands them.<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>interactive<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">let</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>l <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>buffer<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>substring <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>point<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>at<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>bol<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>point<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
          a<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
          <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">if</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-operator z-logical z-lisp">and</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>looking<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>at <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>[ <span class="z-constant z-character z-escape z-lisp">\t</span>]*$<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
               <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">string</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>match <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>^[ <span class="z-constant z-character z-escape z-lisp">\t</span>]*><span class="z-constant z-character z-escape z-lisp">\\</span>([a-zA-Z]+<span class="z-constant z-character z-escape z-lisp">\\</span>)$<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span> l<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
              <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">let</span><span class="z-keyword z-operator z-arithmetic z-lisp">*</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>key <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>match<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">string</span> <span class="z-constant z-numeric z-lisp">1</span> l<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
                     <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>start  <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>point<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>at<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>bol<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
                     <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>end <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>point<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
                <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">when</span>
                    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">cond</span>
                     <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">string</span><span class="z-keyword z-operator z-comparison z-lisp">=</span> key <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>t<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
                      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>insert<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>todays<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>date<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
                      <span class="z-constant z-language z-lisp">t</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
                     <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
                  <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">delete</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>region start end<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
                  <span class="z-constant z-language z-lisp">t</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
                <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">require</span> 'org<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">with</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">eval</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>after<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">load</span> 'org 
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>advice<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>add <span class="z-constant z-character z-lisp"><span class="z-punctuation z-definition z-constant z-lisp">#</span>'org-cycle</span> :before<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">until</span>   <span class="z-constant z-character z-lisp"><span class="z-punctuation z-definition z-constant z-lisp">#</span>'</span> org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>try<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>my<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>template<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>function<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></code></pre><h1 id=Pasting_HTML_in_org_mode>Pasting HTML in org mode</h1><p>This was inspired by <a href=https://emacs.stackexchange.com/questions/12121/org-mode-parsing-rich-html-directly-when-pasting>this stack overflow question</a>. It suggested using <code>xclip</code> to access the clipboard.<p>The problem is that <code>xclip</code> causes emacs to hang, because it forks a child that keeps stdout open. So instead, one can use the emacs backed for getting the xselection from the clipboard.<p>This code requests a text/html selection and checks if it exists. If it exists, it first decodes it using whatever encoding was being used, and then uses pandoc to convert the html to org mode.<pre class="language-el z-code" data-lang=el><code class=language-el data-lang=el><span class="z-source z-lisp">    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-meta z-function z-lisp"><span class="z-storage z-type z-function-type z-lisp">defun</span> <span class="z-entity z-name z-function z-lisp">html2org-clipboard</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>Convert clipboard contents from HTML to Org and then paste (yank).<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>interactive<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">let</span><span class="z-keyword z-operator z-arithmetic z-lisp">*</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>
           <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>text_html <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>gui<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>backend<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">get</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>selection 'PRIMARY 'text<span class="z-keyword z-operator z-arithmetic z-lisp">/</span>html<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
           <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>text_raw <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>gui<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">get</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>selection<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> 
           <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>text_html <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">when</span> text_html
                        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>decode<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>coding<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">string</span> text_html 'unix<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
           <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>text_html <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">when</span> text_html
                        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>shell<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>command<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-keyword z-control z-lisp">to</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">string</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>concat <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>echo <span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span>  <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>shell<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">quote</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>argument text_html<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>|timeout 2  pandoc -f html-native_divs-native_spans -t org<span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
           <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>text <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-operator z-logical z-lisp">or</span> text_html
                   text_raw<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
           <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
        <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">progn</span>  <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>kill<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>new text<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>yank<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
    
    
    <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-keyword z-control z-lisp">with</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">eval</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>after<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">load</span> 'org 
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>define<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>key org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">map</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>kbd <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>C-y <span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> 'html2org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>clipboard<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>define<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>key org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>mode<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-support z-function z-lisp">map</span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>kbd <span class="z-string z-quoted z-double z-lisp"><span class="z-punctuation z-definition z-string z-begin z-lisp">"</span>C-&LTtab><span class="z-punctuation z-definition z-string z-end z-lisp">"</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> '<span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-support z-function z-lisp">lambda</span><span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>interactive<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span> <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>save<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>excursion  <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>back<span class="z-keyword z-operator z-arithmetic z-lisp">-</span><span class="z-keyword z-control z-lisp">to</span><span class="z-keyword z-operator z-arithmetic z-lisp">-</span>heading<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
                                                                      <span class="z-meta z-group z-lisp"><span class="z-punctuation z-definition z-group z-begin z-lisp">(</span>org<span class="z-keyword z-operator z-arithmetic z-lisp">-</span>cycle<span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span><span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
      <span class="z-punctuation z-definition z-group z-end z-lisp">)</span></span>
</span></code></pre><nav><div><a href=/resume.html>â€¹ Resume</a></div><div><a href=/transfer-functions-in-python.html> Transfer Functions in python â€º</a></div></nav></article></main><footer><hr><div class=c><nav><div><a class="js m-protected" href=#aXRhZGV1ZmFAZ21haWwuY29t target=_blank title=Mail><i class="svg mail" title=Mail type=Button></i></a><a href=https://www.linkedin.com/in/ivan-tadeu-ferreira-antunes-filho-8b2b0950/ target=_blank title=LinkedIn><i class="svg linkedin" title=LinkedIn type=Button></i></a><a href=https://www.researchgate.net/profile/Ivan-Tadeu-Ferreira-Antunes-Filho/ target=_blank title=ResearchGate><i class="svg researchgate" title=ResearchGate type=Button></i></a><a href=https://github.com/itf/ target=_blank title=Github><i class="svg github" title=Github type=Button></i></a><a href=https://www.instagram.com/ivan_af_/ target=_blank title=Instagram><i class="svg instagram" title=Instagram type=Button></i></a></div></nav><p class=s90>Â© 2025 Ivan.fyi<p class=s90>Powered by <a href=https://www.getzola.org/ target=_blank>Zola</a> and <a href=https://github.com/jieiku/abridge/ target=_blank>Abridge</a></div></footer><span class=topout> <span class=topleft> </span><a title="Back to Top" class=top href=#><i class="svgs svgh angu"></i></a> </span>